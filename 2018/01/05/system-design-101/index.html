<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>101 Introduction to System Design | Liang Yu&#39;s Website</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="CS183C," />
  

  <meta name="description" content="What is the System DesignSystem Design 101What kinds of Question You Should Expect in the Interviewinterviewee  v.s. interviewer  a web facing service a RESTfule API a peer-to-peer desktop app Design">
<meta name="keywords" content="CS183C">
<meta property="og:type" content="article">
<meta property="og:title" content="101 Introduction to System Design">
<meta property="og:url" content="http://www.yuliang.xyz/2018/01/05/system-design-101/index.html">
<meta property="og:site_name" content="Liang Yu&#39;s Website">
<meta property="og:description" content="What is the System DesignSystem Design 101What kinds of Question You Should Expect in the Interviewinterviewee  v.s. interviewer  a web facing service a RESTfule API a peer-to-peer desktop app Design">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://www.yuliang.xyz/2018/01/05/system-design-101/radar_chart.png">
<meta property="og:updated_time" content="2018-05-17T19:48:57.027Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="101 Introduction to System Design">
<meta name="twitter:description" content="What is the System DesignSystem Design 101What kinds of Question You Should Expect in the Interviewinterviewee  v.s. interviewer  a web facing service a RESTfule API a peer-to-peer desktop app Design">
<meta name="twitter:image" content="http://www.yuliang.xyz/2018/01/05/system-design-101/radar_chart.png">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbe6" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  

  

  


  
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  
</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            rel="noopener noreferrer"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#What-is-the-System-Design"><span class="toc-text">What is the System Design</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#System-Design-101"><span class="toc-text">System Design 101</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#What-kinds-of-Question-You-Should-Expect-in-the-Interview"><span class="toc-text">What kinds of Question You Should Expect in the Interview</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Common-System-Design-Question"><span class="toc-text">Common System Design Question</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Common-Errors"><span class="toc-text">Common Errors</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#What-You-should-Achieve-in-30-Minutes"><span class="toc-text">What You should Achieve in 30 Minutes</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#How-to-Crack-the-Question-with-4S-Method"><span class="toc-text">How to Crack the Question with 4S Method</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Give-a-Scenario"><span class="toc-text">1. Give a Scenario</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-List-possible-Service"><span class="toc-text">2. List possible Service</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Analyze-required-Storage"><span class="toc-text">3. Analyze required Storage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Leave-space-for-Scale"><span class="toc-text">4. Leave space for Scale</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Commone-Design-Questions"><span class="toc-text">Commone Design Questions:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么Google三驾马车（MapReduce-BigTable-GFS-奠定了云计算的基础？"><span class="toc-text">为什么Google三驾马车（MapReduce, BigTable, GFS)奠定了云计算的基础？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Prepare-for-System-Design"><span class="toc-text">Prepare for System Design</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#套路五步"><span class="toc-text">套路五步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#进阶"><span class="toc-text">进阶</span></a></li></ol></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-system-design-101" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">101 Introduction to System Design</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2018.01.05</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>Liang Yu</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/System-Design/">System_Design</a>
  </span>



      
        <span>
          <i class="icon-comment"></i>
          <a href="http://www.yuliang.xyz/2018/01/05/system-design-101/#disqus_thread"></a>
        </span>
      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      

      
      
    </div>
  </header>

  <div class="article-content">
    
      <h1 id="What-is-the-System-Design"><a href="#What-is-the-System-Design" class="headerlink" title="What is the System Design"></a>What is the System Design</h1><h1 id="System-Design-101"><a href="#System-Design-101" class="headerlink" title="System Design 101"></a>System Design 101</h1><h1 id="What-kinds-of-Question-You-Should-Expect-in-the-Interview"><a href="#What-kinds-of-Question-You-Should-Expect-in-the-Interview" class="headerlink" title="What kinds of Question You Should Expect in the Interview"></a>What kinds of Question You Should Expect in the Interview</h1><p>interviewee  v.s. interviewer</p>
<ol>
<li>a web facing service</li>
<li>a RESTfule API</li>
<li>a peer-to-peer desktop app</li>
<li>Design a URL shortening service like bit.ly.</li>
<li>How would you implement the Google search?</li>
<li>Design a client-server application which allows people to play chess with one another.</li>
<li>How would you store the relations in a social network like Facebook and implement a feature where one user receives notifications when their friends like the same things as they do?</li>
</ol>
<h1 id="Common-System-Design-Question"><a href="#Common-System-Design-Question" class="headerlink" title="Common System Design Question"></a>Common System Design Question</h1><p>两种模式：</p>
<ol>
<li>设计某个系统</li>
</ol>
<table>
<thead>
<tr>
<th>US</th>
<th style="text-align:left">China</th>
<th style="text-align:right">Article</th>
</tr>
</thead>
<tbody>
<tr>
<td>Design Twitter</td>
<td style="text-align:left">Wechat 微博</td>
<td style="text-align:right">$1600</td>
</tr>
<tr>
<td>Design Facebook</td>
<td style="text-align:left">RenRen 人人</td>
<td style="text-align:right">$12</td>
</tr>
<tr>
<td>Design Uber</td>
<td style="text-align:left">DiDi 滴滴</td>
<td style="text-align:right">$1</td>
</tr>
<tr>
<td>Design Whatsapp</td>
<td style="text-align:left">Wechat 微信</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td>Design Yelp</td>
<td style="text-align:left">大众点评</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td>Design Tiny URL</td>
<td style="text-align:left">短网址系统</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td>Design NoSQL</td>
<td style="text-align:left">NoSQL数据库</td>
</tr>
</tbody>
</table>
<ol>
<li>设计某个系统内的某个功能</li>
</ol>
<ul>
<li>设计一个功能限制用户的访问频次</li>
<li>设计一个功能统计用户的历史访问记录</li>
</ul>
<h1 id="Common-Errors"><a href="#Common-Errors" class="headerlink" title="Common Errors"></a>Common Errors</h1><ul>
<li>Do Not Throw Keyword Stones to Interviewer<br>这些关键词很高大上，但是没有鸟用，比如：<br>Load Balancer, Memchache, Node JS, MongoDB, MySQL, Sharding, Consistent Hashing, Master Salve, HDFS, Hadoop<br>破壁人：用户至上，如果目前只有2个用户呢？</li>
</ul>
<h1 id="What-You-should-Achieve-in-30-Minutes"><a href="#What-You-should-Achieve-in-30-Minutes" class="headerlink" title="What You should Achieve in 30 Minutes"></a>What You should Achieve in 30 Minutes</h1><p>By strategy we mean a way to approach the problem at an interview. </p>
<ul>
<li>Work Solution 可行解 25%</li>
<li>Special Case 特殊情况 20%</li>
<li>Analysis 分析能力 25%</li>
<li>Tradeoff 权衡利弊 15%</li>
<li>Knowledge Base 知识储备 15%</li>
</ul>
<img src="/2018/01/05/system-design-101/radar_chart.png" title="[]">
<h1 id="How-to-Crack-the-Question-with-4S-Method"><a href="#How-to-Crack-the-Question-with-4S-Method" class="headerlink" title="How to Crack the Question with 4S Method"></a>How to Crack the Question with 4S Method</h1><h3 id="1-Give-a-Scenario"><a href="#1-Give-a-Scenario" class="headerlink" title="1. Give a Scenario"></a>1. Give a <strong>Scenario</strong></h3><p>需要设计哪些功能？要设计得有多牛？<br>Ask | Features| QPS| DAU | Interface</p>
<p>The very first thing you should do with any system design question is to clarify the system’s constraints and to identify what use cases the system needs to satisfy.</p>
<p>– 问面试官，体现交流的能力<br>– 根据面试官的回复，做出合理的分析</p>
<p>Usually, part of what the interviewer wants to see is if you can gather the requirements about the problem at hand, and design a solution that covers them well.</p>
<p>写在一条一条写在纸上</p>
<h3 id="2-List-possible-Service"><a href="#2-List-possible-Service" class="headerlink" title="2. List possible Service"></a>2. List possible <strong>Service</strong></h3><p>将大系统拆分成小服务<br>Split | Application | Module</p>
<h3 id="3-Analyze-required-Storage"><a href="#3-Analyze-required-Storage" class="headerlink" title="3. Analyze required Storage"></a>3. Analyze required <strong>Storage</strong></h3><p>数据如何存储与访问<br>Schema | Data | SQL V.S. NoSQL | File System</p>
<h3 id="4-Leave-space-for-Scale"><a href="#4-Leave-space-for-Scale" class="headerlink" title="4. Leave space for Scale"></a>4. Leave space for <strong>Scale</strong></h3><p>解决缺陷，处理可能遇到的问题<br>Sharding | Optimize | Special Cases</p>
<p>After these 4 steps, you should come up with a workable but maybe not perfect solution</p>
<h2 id="Commone-Design-Questions"><a href="#Commone-Design-Questions" class="headerlink" title="Commone Design Questions:"></a>Commone Design Questions:</h2><ol>
<li><p>News API Design  (注意 pagination. 看看twitter 的 API developer’s guide 会有帮助)</p>
</li>
<li><p>一个music app，选出 top 10 songs</p>
</li>
<li><p>设计，类似翻译系统，但是要写具体接口函数（一些特殊需求。。。。所以切记要问清需求）</p>
</li>
<li><p>typeAhead</p>
</li>
</ol>
<p>typeAhead 的话基本就是用trie， 生成方法就是每次用户search 或者选中一个suggestion ， 就把对应的leaf count++， 然后用这个新的count更新所有parent node的hot word list。 感觉和map reduce 没关系。。。</p>
<ol>
<li>typeAhead这里的hot key words考虑多久的时效性，比如你是按照1 month，1 week，1 day 还是1 hour的数据给出hot key words。. From 1point 3acres bbs<br>思路：如果按1 day来那么就无法展现1个月的情况，如果按1个月的来，那么无法展现新的热词. From 1point 3acres bbs<br>方法一：可以按 每天/每小时 平均值来算<br>方法二：根据不同的场景选不同的， 比如google search 可以按一年来，新鲜事搜索可以按1个月来，新闻搜索可以按一天算</li>
<li>大家都知道要用Trie去存数据，并且Trie是放在cache里的，那么这个cache什么时候去更新？ 鏉ユ簮涓€浜�.涓夊垎鍦拌鍧�.<br>每次用户搜索后就更新<br>怎么更新？<br>因为只是往trie里加分支，所以可以直接加，不用锁<br>要不要加TTL？<br>为了防止cache过大可以加， 可以每隔一段时间对trie清理剪枝</li>
</ol>
<p>你更新的这个cache的频率会对用户query的时效性产生很大的影响，并且你更新也会对数据库和服务器造成额外的负担，你怎么去平衡。<br>multithread scheduling, Trie updating thread has lower priority</p>
<ol>
<li>如果这个服务是面向多个国家的，过了一段时间你发现你的推荐在某些国家点击率很高，有些国家点击率很低，你要怎么优化。总之都和你之前的一系列答案有关。问得相当的细<br>方法一 不同的国家不同的Trie,但这样人们无法看到别的国家的人的热搜<br>方法二 考虑各国人口，比如 count = count in country A/ population of country A<br>方法三 有一些common的 hot word 还有一些country specific 的hot words</li>
</ol>
<p>最后我觉得这种题要想在45分钟内想清楚说清楚别人用5年时间做出来的东西是不可能的，重要的是展示思路吧，这种思路既要有一定发散性，又要有一定合理性，但是也不要太在意是否以及如何实现的问题</p>
<p>最后吐槽一句，我当时靠系统设计也考了翻译系统，然后因为唯独那一轮不好就直接给我挂了。。。。关键是翻译系统我在工作中还是做过的。。。。事后想可能需求没问清楚吧，看到是做过的太兴奋了就直接说了解法，但是忘记交代工作中一些特殊需求。。。。所以切记要问清需求啊。。。。. 涓€浜�-涓夊垎-鍦帮紝鐙鍙戝竷<br>. from: 1point3acres.com/bbs<br>design type a head, 这个就是正常的data collection和data query, data query用in memory trie 從如何boostrap trie到trie sharding, 到end-to-end operation</p>
<ul>
<li><p>top n hot key word怎么生成，问了下map reduce (Map Reduce必须要加)的东西 </p>
<ul>
<li><p>这个service在facebook的用户量是至少几百K每秒的请求，如果你要是一直update leaf count，再加上读的请求，会非常的耗费资源。而且还有一点，你把count放在leaf node的话，那么你的搜索时间就很高，因为你要深入到每一个leaf node里面去取前k个热词，优点是空间少。我答得是把前k个热词放在相应的node上，搜索很快，但是更新麻烦些，内存占用更多，所以处处都是trade off。具体还是得跟面试官不断商量。一般来说都是把用户选择的search的这个记录存在一个log table里，然后用map reduce去更新count。另外一个优化就是用比如1/1000的比例去log用户的搜索，这样可以减少log table的大小。另外你这个Trie是需要serialize到硬盘上，不然断电以后Cache就没了。</p>
</li>
<li><p>生成方法就是每次用户search 或者选中一个suggestion ， 就把对应的leaf count++， 然后用这个新的count更新所有parent node的hot word list。</p>
</li>
</ul>
</li>
<li><p>typeAhead这里的hot key words考虑多久的时效性，比如你是按照1 month，1 week，1 day 还是1 hour的数据给出hot key words。</p>
<ul>
<li>思路：如果按1 day来那么就无法展现1个月的情况，如果按1个月的来，那么无法展现新的热词<ul>
<li>方法一：可以按 每天/每小时 平均值来算</li>
<li>方法二：根据不同的场景选不同的， 比如google search 可以按一年来，新鲜事搜索可以按1个月来，新闻搜索可以按一天算</li>
</ul>
</li>
</ul>
</li>
<li><p>大家都知道要用Trie去存数据，并且Trie是放在cache里的，</p>
<ul>
<li>那么这个cache什么时候去更新？<ul>
<li>每次用户搜索后就更新</li>
</ul>
</li>
<li>怎么更新？<ul>
<li>因为只是往trie里加分支，所以可以直接加，不用锁</li>
</ul>
</li>
<li>要不要加TTL？<ul>
<li>为了防止cache过大可以加， 可以每隔一段时间对trie清理剪枝</li>
</ul>
</li>
<li>你更新的这个cache的频率会对用户query的时效性产生很大的影响，并且你更新也会对数据库和服务器造成额外的负担，你怎么去平衡。<ul>
<li>multithread scheduling, Trie updating thread has lower priority</li>
</ul>
</li>
</ul>
</li>
<li><p>如果这个服务是面向多个国家的，过了一段时间你发现你的推荐在某些国家点击率很高，有些国家点击率很低，你要怎么优化。</p>
</li>
</ul>
<ol>
<li>(Event Online Sale System) 网页event售票系统， 随便聊聊画画conponent图和数据表，讲讲哪里容易failure，说说API，信用卡信息谁处理，遇到大流量怎么分流</li>
</ol>
<p>(面jet的时候被问这题了，面试官一直在强调，如果票很热，瞬间qps可能是几万几十万，你如何处理之类的。。所以我猜concurrency应该是必须要讨论的一个点。)</p>
<ul>
<li>把component图画一画，</li>
<li>写出数据存什么结构，event table,transaction table有哪些column要存. </li>
<li>客户的敏感信息是怎么传递的</li>
<li>如果web service或者core service挂了怎么办?<ul>
<li>做hot back up</li>
<li>可以用其它的back up service来处理</li>
</ul>
</li>
<li>hot spot出现了应该怎么分流<ul>
<li>用product id做成key来做shading(如果细节问你怎么sharding，就把consistent hashing的概念讲一讲)，这样product会被均匀的分配到服务器上。出现某一种票突然很火的概率少一点</li>
<li>比如对于特别热门的event，可以考虑多几台web service，这样可以同时进行处理。</li>
</ul>
</li>
<li>最后做做流量，qps估算</li>
</ul>
<ol>
<li>设计一个“脸书上消耗时间”的功能，记录每天每个用户在脸书上消耗的时间，</li>
</ol>
<ul>
<li><p>要求尽可能的在客户端计算量少，</p>
</li>
<li><p>要求设计相应数据库以及api的输入以及输出. </p>
</li>
<li><p>计算每隔多久向服务器发送数据；</p>
</li>
<li><p>以及如果用户数据错误怎么办</p>
</li>
</ul>
<p>用socket 维持connection , push service 定期update(ex : 10 sec ) login 的时候启动push service 用一个etl process daily agrregation 减少空间, 　用daily log 储存api 就是一个post http call 楼主为啥要求要存data base ? 计算量感觉client 端不太大? 啥情况用户数据会错误呢? </p>
<p>database是给report用的，比如你用hadoop来生成report，那么log数据肯定是不够用的，data error的话，可能有的时候比如socket service挂了，那么这部分的data就丢失了把。可以考虑用log来回复</p>
<ol>
<li><ul>
<li>设计一个照片 app, </li>
</ul>
</li>
</ol>
<ul>
<li><p>但是主要只讨论了 client, 服务器部分面试官不感兴趣. </p>
</li>
<li><p>有offline看照片功能，client和服务器都讨论了</p>
</li>
</ul>
<p>因为我面的安卓，所以就讨论了 app 怎么实现，还有和 server 之间如何通信</p>
<p>我的思路就是 typical 的 client-server system，然后把想到的说出来就好了，我觉得最好是你去 lead 整个 interview，有条理的把所有你知道的说出来，面试官如果有想知道的细节会问你的</p>
<ol>
<li><p>如何design一个在facebook上make comment的method，一个人发comment，同时在网页上浏览的人都能看到</p>
</li>
<li><p>System Design: Typehead<br>– 我每propose一个ideal，面试官就问how to implement it</p>
</li>
<li><p>设计 网页爬虫，给一千台机器，每台机器的带宽有限，每个url只能爬一次<br>download all urls from 1000 hosts. Imagine all the urls are graph. Requirement: Each host has bad internet connection among each other, Has to download url exactly once.</p>
</li>
</ol>
<p>use 10k IOT machine (limited cpu, bandwidth) to crawl wikipedia. 1. don’t repeat same URL; 2. Minimize traffic. 3. save webpage locally (no storage problem), Started with a queue in one machine, discuss traffic up/down, distributed memory design, machine down, health check, backup, consistent hashing, replica to master promotion</p>
<p>这题之后还问，之前那题是在hacker的角度思考，如果现在让你站在网站维护人员的角度，你该怎么防止有人crawl你的网站，不停的给你发request。答用rate limiter，大叔继续问还能用什么方法，怎么区分是machine还是人发过来的request。反正最后感觉他要问的是怎样防止服务器的load过重。这一轮跪的很彻底，稀碎。。。</p>
<p>(是给你10K个机器，然后1B的url，机器之间不能通信，问你怎么样每个机器才能平均的分任务。虽然看过，但是没准备过，答的很不好，基本上大叔提示一下才能答出来一点儿，最后基本相当于大叔给出了答案。<br>这题之后还问，之前那题是在hacker的角度思考，如果现在让你站在网站维护人员的角度，你该怎么防止有人crawl你的网站，不停的给你发request。答用rate limiter，大叔继续问还能用什么方法，怎么区分是machine还是人发过来的request。反正最后感觉他要问的是怎样防止服务器的load过重。) 1B URL是只有一个starting point，需要traverse才能拿到所有的1B url</p>
<p>DDOS攻击基本是无解的，只有做到比黑客更强大，最好的方法就是好多应用共用CDN，在洪泛的时候靠大量反向代理hold住(有点大家一起买保险的意思)，然后学习黑客的攻击行为，封ip(实际上吊的DDOS的ip你是封不完的，他们甚至在网络第三层就给你的交换机踢爆了)，然后</p>
<p>报警</p>
<p>能发起巨量DDOS的通常是大型黑客组织和黑社会组织，对口处理单位不是技术部</p>
<p>早看到这个帖子就好，我也被问了这个crawler的问题，纠缠了十几分钟后突然意识到这完全是个brain teaser式的system design，然后想到了类似UUID hashing，算是蒙混过关，又问了两个follow up问题，第二个没想好时间就到了</p>
<ul>
<li>如何判断crawling结束</li>
<li>如果一半机器比另一半快怎样分配</li>
</ul>
<p>思路就是每台机器都从起始点开始，然后对拿到的url做hash，事先规定好每台机器都只做那些hash value的job，如果hash的值跟当前机器的预定值不一样就skip，一样才继续crawl</p>
<p>就是题目里说的啊，10K个机器来crawl 1B URL。机器之间不能通信。<br>然后第二题是一个网站怎样阻止被机器不停的发请求，然后减轻服务器的负担。</p>
<ol>
<li><p>设计 poi</p>
</li>
<li><p>design type ahead system</p>
</li>
<li><p>FB 的 privacy setting 设计，使得用户的post可以被朋友的朋友看见</p>
</li>
</ol>
<p>户分组 - 比如我这条post选了指定分组可见。如何存储。如何推送给指定分组。如果有新的朋友没有分组，怎么给他们显示一类的。还问了db sharding神马的</p>
<p>privacy setting, 就是被everyone可见，只被朋友的朋友可见，group可见，问底层SQL怎么存（每一column是什么，怎么Join)，问存friend mapping怎么存，用SQL存和用noSQ存friend mapping的trade off. 然后问friend of friend怎么找，之前看过面经，直接说出最基本的n^2和两种O(n)方法，结果没一种是面试官想要，只能跟着面试官的提示走，一路看面试官的语气、表情、以及对我提出方案的反应，揣测面试官想要的解法。之后就是判断需要多少server存等，整个感觉就是被面试官带着飞的感觉</p>
<p>大概就说了一下存的时候存一个column是分组，每次pull news的时候把朋友名单拿出来，再确定是不是分组里面的。其实我个人感觉系统设计没有正确答案，如果把情况都考虑到，能说得通，就可以了。因为边design你自己会面临很多小的选择。边说边看面试官的反应，我自己design这方面也比较弱。说的时候不太有信心。问了很多次“这样可以吗？”微笑小哥就点点头，或者说-你决定吧。我就硬着头皮说，最后他说嗯差不多。顺着我的思路问了一些小细节。比如要不要cache或者db sharding 的key是什么啦。就完事了</p>
<p>面试官先让我说怎么存用户数据，我基本就是照着他们tao那个paper的思路说的，然后问了一些saclability的问题，不是特别深入，就是sharding，replication，consistent hashing什么的，然后问怎么优化privacy setting，我提出的做法貌似跟他们的做法不一致，然后他提醒了我一下，我就按照他提醒的思路说了，具体他怎么提醒的，以及后来我怎么说的其实lz也忘了，因为我当时的确没太理解他们为啥那么设计，不过按照面试官的思路说总不会出错的。。。</p>
<p>privacy setting. 说是每个user有一个friend list, user可以发Post, 问如何设计friends可见。后来follow up 问如何设计user朋友的朋友也可见</p>
<p>刚面FB onsite, 问了一道design题。privacy setting. 说是user可以发Post, 问如何设计friends可见后来follow up 问如何设计user朋友的朋友也可见，我说先找user的朋友，再找user朋友的朋友，他说这样就O(N^2)了，问有没有O(N)来设计friend of friend可见的方法？</p>
<p>今天问了FB专门做privacy setting的大牛，说”This can be done simpler, without any extra writes.<br>A hint: You are thinking about the problem as “How to check if C is a friend<br>of friends of A”. But it is possible to rephrase the question in an other<br>way which will make the problem much simpler to solve. “</p>
<p>每次有添加好友或者删除好友的时候，就顺便告诉一下所有的好友，嘿，我刚加了一个好友，或者我刚黑了一个好友，麻烦你们在你们的好友的好友的列表中把他踢了。然后发帖的时候就根据这张表来推送post。</p>
<p>补充内容 (2017-3-28 05:04):<br>麻烦你们在你们的好友的好友的列表中把他加或踢了</p>
<p>参考下fb TAO那篇paper</p>
<p>补充内容 (2017-3-25 11:24):.鐣欏璁哄潧-涓€浜�-涓夊垎鍦�<br>之前看TAO那篇paper想过这个题。我的想法是在发帖给权限时，直接query TAO中一个hop之内friends节点可见，就是freind可见。两个hop就是F of F。然后吧query到的结果写入帖子节点的privacy信息中。</p>
<p>补充内容 (2017-3-25 11:26):<br>当有F of F看这个人的页面时，就执行query这些post节点的操作。如果post节点的privacy信息包含当前query发起者，则返回。</p>
<p>design, privacy setting, 就是被everyone可见，只被朋友的朋友可见，group可见，问底层SQL怎么存（每一column是什么，怎么Join)，问存friend mapping怎么存，用SQL存和用noSQ存friend mapping的trade off. 然后问friend of friend怎么找，之前看过面经，直接说出最基本的n^2和两种O(n)方法</p>
<hr>
<p>FB 的 privacy setting 设计，怎么设计api，code大概怎么写，使用哪些数据，数据怎么存，要支持下列功能.</p>
<ol>
<li>Fiend 可见， Friend of Friends 可见</li>
<li>每个user可以自己设些group，把一些user加进每个Group，其他用户不知道他设的group是什么，怎么让group里面的人看到我发的状态？怎么存group？</li>
</ol>
<p>以上是题目。思考一下，我觉得有可能需要讨论的有几个方面</p>
<ol>
<li>friendship 怎么存。  这个一般来说都是存成  adjacency list.<br>那么SQL 和NoSQL 各自的<br>SQL<br>FromUser  ToUser   Propertiy<pre><code>A                                        B          Mute
B                                        A           
</code></pre></li>
</ol>
<p>要知道 A 的朋友 select <em> from friend where from_user = A.<br>要知道 A 的朋友的朋友   select </em> from friend where from_user in (select * from friend where from_user = A)    </p>
<p>NoSQL<br>row_key(user_id), col_key(friend_user_id),  比如<br>A :  B,  C. Waral 鍗氬鏈夋洿澶氭枃绔�,<br>B :  A,<br>C:   A . visit 1point3acres.com for more.<br>要知道A的朋友 listA = query(A)    O(1)<br>要知道A的朋友  for each key in listA   query(key)   O(n). </p>
<p>那么各自的trade off 是什么？  (这里暂时不讨论scale，单纯就存储方式来看）</p>
<p>怎么存group？<br>sql： 用一个 group table<br>group   user<br>    1        B<br>    1        C. </p>
<p>NoSQL:  group_id  as key,  user_id as column key.</p>
<p>当然也可以像facebook TAO 那样。但是我觉得好像太复杂了，不知道面试的时候讨论TAO是不是有点过了，除非面试官正好要求你走这条路。<br>. 1point 3acres 璁哄潧<br>. Waral 鍗氬鏈夋洿澶氭枃绔�,</p>
<ol>
<li><p>怎么聚合朋友，以及朋友的朋友发的状态。一般来说就是讨论 PULL 和 PUSH</p>
</li>
<li><p>Pull Model: 鏉ユ簮涓€浜�.涓夊垎鍦拌鍧�.<br>获得朋友列表（n）， 和朋友的朋友列表（n^2)，对每个人拿他的。. 鍥磋鎴戜滑@1point 3 acres</p>
<pre><code>Read: n^2 time
Write: 1
</code></pre></li>
</ol>
<p>怎么处理group的问题？？<br>. visit 1point3acres.com for more.<br>  缺点： pull的时间可能很长，读的时间慢<br>    优点： 实时性好.</p>
<ol>
<li>Push Model<br>有一个timeline table, 一个人发帖的时候，根据发帖的设置，找到可以push的list，然后分别写到他们的timeline table里面。. From 1point 3acres bbs<br>Read: 1 read<br>Write: N^2 ( Async write)</li>
</ol>
<p>怎么处理group的问题？？<br>在push的时候，可以根据当前用户的设定（给谁看，不给谁看），写到不同人的timeline table，比较容易解决。<br>-google 1point3acres<br>缺点：写时间太长，如果朋友巨多。<br>优点：读的时间快，写可以异步。</p>
<ol>
<li>怎么scale，  还在整理，会在回复里面继续。，希望大家能提出。总之就是cache， sharding， replica. </li>
</ol>
<p>Friendship:  cache friend list, reduce read time. 鏉ユ簮涓€浜�.涓夊垎鍦拌鍧�. </p>
<p>Pull Model<br>a. 对于每个用户，都缓存他的最近的POST， N个用户，就<br>b. 对于我自己，cache我的timeline.(就是聚合好的结果)</p>
<p>Push Model</p>
<hr>
<ol>
<li>设计脸书search</li>
<li>TinyURL</li>
<li><p>client 给 server 传输文件 的系统。 一个/多个clients &lt;-&gt; 一个／多个 server</p>
</li>
<li><p>POI<br>楼主愿意说一下POI的回答思路吗， 我看到这个面经很多次了，但是还是不确定方向。 是不是讲一堆GeoHashing, 怎么画格子，将二维降成一位，之后存储成Trie。 存储的时候根据Category 存。 Query的时候，根据Category先找到那颗Trie，之后根据精确度找到附近的N个POI，返回. 或者还需要考虑shard trie? 希望楼主给点指点。谢谢！</p>
</li>
</ol>
<hr>
<p>13).<br>Design a simple message system.  是个国男大哥，很严肃，但估计也没有刁难我。就是基本的怎么发信息，怎么收信息，然后怎么通知receiver，如果有新的消息了</p>
<p>(14)<br>design: design fb inbox search    —&gt; just focus the post</p>
<p>(15)<br>设计一个 hack pokemon go的 app。 用户不用出门就能抓到pokemon</p>
<p>(16)<br>(16.1)<br>一个找最近朋友系统</p>
<p>设计推荐好友的service end to end. design的问题比如算一下这个service read和write的throughput，database partitioning，怎么存好友推荐要用到的数据，怎么更新权重（比如有些被推荐的好友从来不被点击，那下次就不应该在排在前列），粗略的讲讲如何进行好友推荐的排序（哪些因素可以影响推荐的权重）</p>
<p>(17)<br>(17.1)<br>(17.2).<br>(17.3)<br>设计个类似yelp的东西</p>
<p>设计 poi</p>
<p>我当时答geohash是可以的，剩下的就是sql存，找公共前缀，然后再是算空间，机器数，再就是怎么sharding 分布式，建index找，pre/cache result，底层怎么存。 整个flow差不多就是这样，中间有些细节和面试官讨论了下</p>
<p>我答得应该不算好，因为比较糊涂面试官到底想看啥。<br>基本idea就是geohash。把地表分成小的rectangle，比如10 square ft。里面存这块区域的point of interest比如商店，邮局等等。区域构成树的结构，大的区域下面子节点是小的区域。按区域shard。这样由client发的request得到position，然后找到对应的rectangle，再从这个rectangle 向周围BFS一定量的步数找到所有POI按远近排，然后同样距离内按其他的criteria如用户preference排。返回数量由client端决定。比如web端可以返回多一些，比如100个，mobile端返回少点，比如20个<br>这个感觉没那么好因为面试官喜怒不形于色，反馈比较少，让我不清楚他想要什么，或者该往哪方面展开</p>
<p>被问道的题目是POI。其实这个题目我是准备过的，但是面试中不同的是，不可以用exsiting lib like google s2 or geohash，需要自己给出hash的方式。在这个地方纠结了很久，导致之后很不顺畅，一直在围绕我hash的方式问问题。最后结束的时候，面试官说this works，我觉得是挂了，但还是希望面试官抬一手，feedback不要写太差.<br>Update: 听了某位同学的意见，因为觉得过于focus在geohash algorithm design，导致完全没有时间来进行真正的system design  (use quadtree instead of geohash)</p>
<p>设计一个系统可以查询10 miles之内的建筑物。我就说用geohash，将建筑物存在key-value类的NoSQL中。查询时查prefix。面试官并没有质疑什么，然而feedback却不好。现在回想起来，可能是我分析column familar NoSQL和Key Value NoSQL的tradeoff的时候没有讲清楚。我也不是很清楚到底应该用哪种更适合，如果大神们看见了请解释解释</p>
<p>design POI, geoHash解之。要求先估算需要多少machine，再说geohash。白板画需要几部分和之间关系，写backend POI meta data，算需要多少machine来存。最后有拍照</p>
<p>(18)<br>设计谷歌搜索，涉及 表， 文件系统，缓存，脸书专用缓存论文，分片，备份</p>
<h3 id="为什么Google三驾马车（MapReduce-BigTable-GFS-奠定了云计算的基础？"><a href="#为什么Google三驾马车（MapReduce-BigTable-GFS-奠定了云计算的基础？" class="headerlink" title="为什么Google三驾马车（MapReduce, BigTable, GFS)奠定了云计算的基础？"></a>为什么Google三驾马车（MapReduce, BigTable, GFS)奠定了云计算的基础？</h3><p>答： 这三个系统正好在distributed环境下拆解了传统数据库的三大基本功能：</p>
<ul>
<li>GFS: distributed persistent storage， </li>
<li>BigTable: distributed structured data access/indexing，</li>
<li>MapReduce：distributed data processing</li>
</ul>
<p>而Cassandra/Dynamo本质上也是为了实现distributed structured data access and persistent storage，因此功能上和BigTable+GFS是近似的。<br>再回到NoSQL的基本原则之一，不保证数据的consistency，由业务层来完成数据的join/processing，这就是MapReduce上场的地方了。<br>因此这三家马车组合起来，正好是distributed环境下的一个database。</p>
<p>(19)<br>(19.1)<br>设计一个单机的KV缓存<br>Design memcache. 答LRU应该可以, 但问了很多bottleneck和threadsafe<br>. 鐗涗汉浜戦泦,涓€浜╀笁鍒嗗湴<br>首先给了一堆数据：机器72G内存，16个core，10T硬盘.<br>需要实现的API是：get(key), put(key, value), delete(key)-google 1point3acres<br>key max size 1k, average 100bytes, value max size 1M, average size 1k.<br>考虑用啥protocol，locking，memory management。如何lock，如何减少lock提高performance<br>如何保证顺序</p>
<hr>
<p>(20)<br>短url，全程我在说，他也没问什么问题</p>
<p>(21)<br>Design twitter feed system</p>
<p>news feed就是问 - 比如这些是用户写的一条post，有用户基本信息，内容，图片，时间等等（当时还画了一下基本ui），如何拿到这些信息，如何存储. 还问了如果有新的feature，比如加了一个button，如何让没有update app的人仍然流畅使用他们现有的。scale倒是没细问。时间有点长了也记不起来剩下问了什么了。。<br>. Waral 鍗氬鏈夋洿澶氭枃绔�,<br>(22). more info on 1point3acres.com<br>设计一个上传video, 可以看自己或者朋友的video的. 说实话, 整个过程, 不是特别清楚, 他到底想看什么…所以就是他想看哪块, 我就细讲一下那块. 我自己感觉沟通不是太畅, 最后, 时间到了. 系统设计这种东西, 本身就是开放型的讨论, 运气, 人缘很重要, 这也不是我能把握的</p>
<p>(23)<br>设计一个在线游戏的排名系统。游戏是回合制的，每一回合结束后都会获得一个分数。玩家可以在游戏中添加好友，每个玩家有任意个好友。在每一回合结束后，游戏界面需要弹出两个排序的表格：（1）玩家及其所有好友的最高分数排序top 10；（2）玩家的分数在所有用户（million级别）最高分数中的排名，以及该排名的前十位、后十位的玩家及分数<br>. 1point3acres.com/bbs<br>(24). 鐣欏鐢宠璁哄潧-涓€浜╀笁鍒嗗湴<br>design ETF arbitrage system: 每一个ETF由许多不同的stock组成， ETF有两个价格， 一个是underlying asset price, 就是所有stock加起来的价格， 一个是市场目前报价， 也就是</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ETF</span>&#123;</span></span><br><span class="line">     <span class="keyword">double</span> market_price;. </span><br><span class="line">     <span class="keyword">double</span> underlying_asset_price;</span><br><span class="line">     <span class="built_in">vector</span>&lt;pair&lt;ticker, qty&gt;&gt; underlying_asset</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>有feed不断提供所有ETF的报价和每个stock的报价， 寻找arbitrage的机会（当underlying_asset_price 不等于market_price的时候就可以arbitrage ）<br>这道题没见过还按照之前的正常想法设计不同的service group， 面试官不太满意， 后来才反应过来这个是要设计一个ultra low latency system， 而不是设计分布式系统. Waral 鍗氬鏈夋洿澶氭枃绔�,</p>
<p>(25)<br>Design 一个 status post 系统，支持存储status和搜索包含某一个string或者某几个string的所有statuses</p>
<p>(26)<br>design是设计post和friend的搜索 支持多个关键词</p>
<p>(27)<br>Desgin an Advertisement (AD) statistic system. 每次用户登录的时候，系统都会show几个广告给他。广告总共有K种类别，可以认为K&lt;=10。用户看到广告可能会点击，Click Through Ratio (CTR) = 用户点的广告数量/给用户看的广告数量。注意若同一个广告被用户点击了多次，只算一个click。设计一个系统，answer the following two types of queries: </p>
<ol>
<li>Given a user, return his CTR for all types of ADs.. </li>
<li>Given an AD type, return its average CTR ovre all the users.<br>Follow ups:.<br>a. What if K becomes very large? for example, we consider each product as one type, thus K  can be as large as 10000.<br>b. New query type:  Given an AD type, return the top-X users with highest CTR. 1&lt; X &lt; 100<br>个人感觉这个题似乎更偏向数据库设计？我当时其实有点懵，花了很多时间解释如何设计relationalDB, 处理这些query,以及可能的优化，e.g., 这个application明显是write-heavy的，所以caching(delayed write)会很有用。答完没有什么感觉，但面试官表示满意”Looks your design works well”. 但是面无表情所以不知道是不是套话<br>评分</li>
</ol>
<hr>
<ol>
<li>Table Design</li>
<li>Design User System</li>
<li>Design a key-value storage</li>
<li>Memccahe, Redis, MongoDB, Dynamo DB, Cassandra</li>
</ol>
<ol>
<li>primary/foreigh key, table, row, attribute, transaction, log, lock, lifecycle</li>
</ol>
<p>OOD </p>
<ol>
<li>toy factory</li>
<li>shape factory</li>
<li>parking lot</li>
<li>blackj</li>
<li>elevator</li>
<li><p>achievement system</p>
</li>
<li><p>Web System Design</p>
</li>
<li>what happend if you visit www.google.com?</li>
<li>How to design tiny url</li>
<li>How to design rate limiter?</li>
<li>How to design data dog<br>– Web, Consistent Hashing, Memcached, </li>
</ol>
<ol>
<li>Search Engine</li>
<li>crawler</li>
<li>typehead</li>
<li>inverted index</li>
</ol>
<p>– failure rate, DNS, file server, web server, timeout, content delivery network, cookie, HTTP, retention rate, cache, lazy load.<br>rate limiter, QPS, </p>
<ol>
<li>Mapreduce &amp; Distributed File System</li>
<li>Inverted index</li>
<li>anagram</li>
<li>Word count</li>
<li><p>Distributed File System Design</p>
</li>
<li><p>Location Based Realtime System</p>
</li>
<li>Design Yelp</li>
<li>Design Uber</li>
<li>Design Whatsapp</li>
</ol>
<p>– Location Based, Realtime System</p>
<h2 id="Prepare-for-System-Design"><a href="#Prepare-for-System-Design" class="headerlink" title="Prepare for System Design"></a>Prepare for System Design</h2><p>考察的要点：The distributed backend service design under heavy traffic。每天的request都是billion级别的。而design的核心就是tradeoff。在有限的时间内，给出几个方案，在列出每种方案的时候，<br>同时给出该方案的优点和缺点。并结合当前的场景，给出该方案是否可行，并选择处一个最合适的方案。</p>
<h3 id="套路五步"><a href="#套路五步" class="headerlink" title="套路五步"></a>套路五步</h3><ol>
<li><p>User case:<br>面试官讨论该系统需要实现什么功能，大部分设计都需要实现“读”和“写”两个基本功能。这样就确定了功能边界。</p>
</li>
<li><p>System constraint: – 确定性能边界，也会决定你的设计框架。<br>和面试官明确max requests/day, QPS, storage size, latency，availability<br>或者，需要结合Facebook本身的traffic, active user 等数值进行估算（这就要求对各家的这些number要有大概认知</p>
</li>
<li><p>Abstract design:<br>先给出high level的design，自顶向下逐步细化。high level都是三层：</p>
</li>
</ol>
<ul>
<li><p><strong>API</strong><br>API是interface，负责和调用方打交道。</p>
</li>
<li><p><strong>Application layer</strong><br>Application layer实现所有业务逻辑，为了实现distributed和scalability，要求application layer是stateless的（无状态：即server不保存任何request相关的data, 所有server的code base完全一致）. 这样，如果application不能host更多request时，简单的增加更多机器即可（horizontal scalability)。</p>
</li>
</ul>
<p>为了实现load balance和failover, 在application layer入口加入load balancer（比如ZooKeeper)。</p>
<ul>
<li><strong>Data layer</strong><br>Data layer实现所有业务数据的读写。一般分为cache和persistant storage两层。<ul>
<li>Cache 让high request data能够快速读写(write through/write back)，</li>
<li>Persistant storage保证所有数据不会丢失。</li>
</ul>
</li>
</ul>
<ol>
<li>Drill down：针对具体部分展开深入讨论<br>针对业务逻辑的实现方案<ul>
<li>比如timeline到底是用fan-out-write还是fan-out-read。<ul>
<li>Twitter用fan-out-write（将new feed直接写到follower的timeline里)</li>
<li>Facebook却用fan-out-read（在读的时候实时抓取相关用户的feeds并merge/rank)。</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>这两个timeline是有本质不同的，twitter的timeline是比较传统的按时间顺序呈现你follow的人的feeds，<br>而Facebook的news feeds更像一个timeline + social graph search, 不仅有好友最新的post，还有基于social graph搜索之后的相关结果（可能是你朋友的朋友，或者朋友赞过的照片，等），并且可能会有个性化结果。</p>
<p>回归到fan-out-read/fan-out-write一个本质区别是，如果request/answer pattern越不确定<br>（比如web search就是一个极端例子，query pattern趋近无限），或者answer features 需要agile的变化，那么用fan-out-read越好（read所有candidate后，灵活的组织结果）。</p>
<p>References:<br><a href="https://www.quora.com/What-is-fan-out-write-and-fan-out-read-in-scalability" target="_blank" rel="noopener">What is fan out write and fan out read in scalability?</a><br><a href="https://toutiao.io/posts/125383/app_preview" target="_blank" rel="noopener">几个大型网站的 Feeds (Timeline) 设计简单对比</a></p>
<p>针对data layer的实现方案(</p>
<ul>
<li>cache的设计，比如从基本的LRU问到distributed cache，</li>
<li>或者是cache+storage设计，比如BigTable+GFS or Cassandra or Dynamo</li>
</ul>
<p>当你给出每个idea时，需要同时给出这种方案本身的优缺点，并最终结合我们之前确定的1,2(功能边界和系统约束），选择最适合的方案。</p>
<ol>
<li>Bottlenect<br>如果还有时间，可以回顾我们已经设计好的系统，提出这个系统从整体上看，最可能出现瓶颈的地方，并和面试官互动的讨论。</li>
</ol>
<h3 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h3><p>有了以上框架，就需要针对框架里提到的各种主流技术去进行深入了解。在看文档或paper时，要多思考总结，互相比较，抽象理解。</p>

    
  </div>
</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，支持Liang Yu</div>
        <ul class="theme.donation.items.length">
        
          <li class="item">
            <img src="/images/some_wechat.png" alt="">
          </li>
        
          <li class="item">
            <img src="/images/some_alipay.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2017/10/22/design-pattern-command/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2018/01/06/news-feed-system/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    
  <section class="disqus-comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>

  <script>
    var disqus_shortname = 'forsigner';
    
    var disqus_url = 'http://www.yuliang.xyz/2018/01/05/system-design-101/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

  <script id="dsq-count-scr" src="//forsigner.disqus.com/count.js" async></script>



    




    

    
	
    
	
  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
